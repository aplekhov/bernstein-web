!!!
%html{:xmlns => "http://www.w3.org/1999/xhtml"}
  %head
    %title
      OSC Web interface

    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}
    %meta{:content => "width=device-width, initial-scale=1.0", :name => "viewport"}

    %script{:src => "/javascripts/jquery-1.11.1.min.js", :type => "text/javascript"}  
    %script{:src => "/javascripts/bootstrap.min.js", :type => "text/javascript"}
    %script{:src => "/javascripts/jquery.osc.js", :type => "text/javascript"}


    %link{:rel => "stylesheet", :href => "/css/bootstrap.min.css", :media => "screen"}


  %body
    %h1 Open Sound Control (OSC) web interface
    %form.form-inline.osc
      %fieldset
        %legend Input an OSC message
        %label OSC message 
        %input{type: 'text', name: 'message_string', autocomplete: 'off', placeholder: 'ex: /synth/filter 453 2.3'}
        %button.submit{type: 'submit', autocomplete: 'off'} Send Message

      .row
        .span2.status Status:
        %img.spinner{:src => 'spinner.gif', :style => 'display:none'}

      %table.table.table-bordered.message-log
        %caption Sent Messages:
        %thead
          %tr
            %td Time
            %td Message
        %tbody
          %tr.info.template{:style => 'display:none'}
            %td.time
            %td.message



  :javascript 
    $('form.osc').submit(function(event){
        event.preventDefault();
        $(this).find(':input').attr("disabled","disabled");
        $(this).find('.spinner').show();
        $(this).find('.status').text('Status:');
        var origMessage = $(this).find(":input[name='message_string']").val();
        var message = origMessage.split(' ');
        $.sendOSCMessage(message.shift(),message, function(){
          var form = $(this);
          form.find(':input').attr("disabled",false);
          form.find('.status').addClass('text-success').text('Status: Success!');
          form.find('.spinner').hide();
          var newRow = $('tr.template').clone().removeClass('template');
          newRow.find('.time').text((new Date()).toTimeString());
          newRow.find('.message').text(origMessage);
          $('.message-log tbody').append(newRow);
          newRow.fadeIn();
          $(this).find(":input[name='message_string']").val('');
          },
          {
            onError: function(error){
              var form = $(this);
              form.find('.status').addClass('text-warning').text('Status: Error!');
              form.find(':input').attr("disabled",false);
              form.find('.spinner').hide();
            },
            context: this
          }
        );
      });
